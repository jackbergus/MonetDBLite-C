for $e in doc("$TSTTRGDIR/sf0.1.xml")//eNest[@aFour=3] 
return
  if (exists($e//eNest[@aSixteen=3]//eNest[@aSixteen=5]//eNest[@aLevel=16])) then 
  <firstLevel aUnique1="{$e/@aUnique1}">
  {
    for $c1 in $e//eNest[@aSixteen=3] where exists($c1//eNest[@aSixteen=5]//eNest[@aLevel=16]) return
    <secondLevel aUnique1="{$c1/@aUnique1}">
    {
      for $c2 in $c1//eNest[@aSixteen=5] where exists($c2//eNest[@aLevel=16]) return
      <thirdLevel aUnique1="{$c2/@aUnique1}">
      {
        for $c3 in $c2//eNest[@aLevel=16]  return
        <fourthLevel aUnique1="{$c3/@aUnique1}">
        </fourthLevel>
      }
      </thirdLevel>
    }
    </secondLevel>
  }
  </firstLevel>
else ()
