for $e in doc("$TSTTRGDIR/sf0.1.xml")//eNest[@aLevel=11] 
return
  if (exists($e//eNest[@aFour=3]) and exists($e//eNest[@aSixtyFour=3])) then 
  <ancester aUnique1="{$e/@aUnique1}" aLevel="{$e/@aLevel}">
{ 
for $c1 in $e//eNest[@aFour=3 and position()=1] return
    <descendant1 aUnique1="{$c1/@aUnique1}" aFour="{$c1/@aFour}">
    </descendant1>
}
{
for $c2 in $e//eNest[@aSixtyFour=3 and position()=1] return
    <descendant2 aUnique1="{$c2/@aUnique1}" aSixtyFour="{$c2/@aSixtyFour}">
    </descendant2>
}
  </ancester>
else()
