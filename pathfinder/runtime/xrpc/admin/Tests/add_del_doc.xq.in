(:
  1. add two xmark documents and show the results;
  2. delete the two added documents and show the results.

  Test the following admin functions:
  - adm:collections()
  - adm:documents()
  - adm:documents($collections)
  - adm:add-doc()
  - adm:del-col()
  - adm:del-doc()
:)
import module namespace adm = "http://monetdb.cwi.nl/XQuery/admin/"
                        at "$TSTSRCBASE/runtime/xrpc/admin/admin.xq";
(execute at {"$HOST:$XRPCPORT"}
            {adm:add-doc("$TSTSRCBASE/runtime/xrpc/admin/xmark1.xml",
                         "xmark1.xml", "xmark", 10)},
 execute at {"$HOST:$XRPCPORT"}
            {adm:add-doc("$TSTSRCBASE/runtime/xrpc/admin/xmark2.xml",
                         "xmark2.xml", "xmark", 10)}
)
<>
import module namespace adm = "http://monetdb.cwi.nl/XQuery/admin/"
                        at "$TSTSRCBASE/runtime/xrpc/admin/admin.xq";
(
text { "&#10;  "},
<collections-after-add>{
    for $c in execute at {"$HOST:$XRPCPORT"} {adm:collections()} return
        ( text { "&#10;    " },
          element { name($c/self::node()) } {
              element numDocs {string($c/@numDocs)},
              element size {string($c/@size)},
              element updatable {string($c/@updatable)},
              $c/text()
          } ),
    text { "&#10;  "}
}</collections-after-add>,
text { "&#10;  "},
<documents-after-add>{
    let $docs := execute at {"$HOST:$XRPCPORT"} {adm:documents()} return
        for $d in $docs return
            ( text { "&#10;    " },
              element document {
                  element updatable {string($d/@updatable)},
                  element collection {string($d/@collection)},
                  $d/text() } ),
    text { "&#10;  "}
}</documents-after-add>,
text { "&#10;  "},
<documents-of-collection-after-add>{
    let $docs := execute at {"$HOST:$XRPCPORT"} {adm:documents("xmark")} return
        for $d in $docs return
            ( text { "&#10;    " },
              element document {
                  element updatable {string($d/@updatable)},
                  element collection {string($d/@collection)},
                  $d/text() } ),
    text { "&#10;  "}
}</documents-of-collection-after-add>,
text { "&#10;"}
)
<>
import module namespace adm = "http://monetdb.cwi.nl/XQuery/admin/"
                        at "$TSTSRCBASE/runtime/xrpc/admin/admin.xq";
execute at {"$HOST:$XRPCPORT"} {adm:del-col("xmark")}
<>
import module namespace adm = "http://monetdb.cwi.nl/XQuery/admin/"
                        at "$TSTSRCBASE/runtime/xrpc/admin/admin.xq";
(
text { "&#10;  "},
<collections-after-del>{
    execute at {"$HOST:$XRPCPORT"} {adm:collections()}
}</collections-after-del>,
text { "&#10;  "},
<documents-after-del>{
    execute at {"$HOST:$XRPCPORT"} {adm:documents()}
}</documents-after-del>,
text { "&#10;  "},
<documents-of-collection-after-del>{
    execute at {"$HOST:$XRPCPORT"} {adm:documents("xmark")}
}</documents-of-collection-after-del>,
text { "&#10;"}
)

