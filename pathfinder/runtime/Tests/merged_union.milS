module(pf_support);

var a:=new(oid,int);
a.insert(oid(0),0);
a.insert(oid(1),0);
a.insert(oid(2),0);
a.insert(oid(3),2);
a.insert(oid(4),4);
a.insert(oid(5),4);
a.insert(oid(6),4);
a.insert(oid(7),6);
a.insert(oid(8),8);
a.insert(oid(9),8);
a.access(BAT_READ);

var b:=new(oid,int);
b.insert(oid(10),1);
b.insert(oid(11),1);
b.insert(oid(12),1);
b.insert(oid(13),3);
b.insert(oid(14),5);
b.insert(oid(15),5);
b.insert(oid(16),5);
b.insert(oid(17),7);
b.insert(oid(18),9);
b.insert(oid(19),9);
b.access(BAT_READ);

var c:=[str](a);
var d:=[str](b);

print(a,c);
print(b,d);

var x := merged_union(a,b,c,d);

print(x.project(nil));
print(fetch(x,0),fetch(x,1));


a := a.reverse().mark(oid(100)).reverse().copy();
b := b.reverse().mark(oid(110)).reverse().copy();

var c:=[str](a);
var d:=[str](b);

print(a,c);
print(b,d);

var x := merged_union(a,b,c,d);

print(x.project(nil));
print(fetch(x,0),fetch(x,1));

