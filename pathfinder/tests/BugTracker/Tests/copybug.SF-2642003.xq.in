pf:add-doc("$TSTSRCDIR/testdoc.SF.2642003.xml","testdoc.SF.2642003.xml",10)
<>

doc("testdoc.SF.2642003.xml") 
<>

let $doc := doc("testdoc.SF.2642003.xml") 
let $path := $doc/reports/folder[@name='builtin'] 
let $bm := $path/report-definition[@name="Cookies"] 
let $topath := $doc/reports/folder[@name='admin'] 
let $copy_bm := element report-definition { 
  $bm/@*[not(name()='name')], 
  attribute name {'Cookies'}, 
  $bm/* 
} 
return do insert $copy_bm as last into $topath 

<>


doc("testdoc.SF.2642003.xml") 
<>

let $doc := doc("testdoc.SF.2642003.xml") 
let $path := $doc/reports/folder[@name='admin'] 
let $bm := $path/report-definition[@name="Cookies"] 
let $new_bm := element report-definition { 
  attribute name {"Cookies"}, 
  attribute project {"*"}, 
  attribute shared {"true"}, 
  $bm/content, 
  element description {"Reports cookies as a table and as details."}, 
  element expertnote {"Copied this report template to user admin for testing purposes."} 
} 
return do replace $bm with $new_bm 

<>


doc("testdoc.SF.2642003.xml") 
<>

let $doc := doc("testdoc.SF.2642003.xml") 
let $path := $doc/reports/folder[@name='admin'] 
let $bm := $path/report-definition[@name="Cookies"] 
let $topath := $doc/reports/folder[@name='admin'] 
let $copy_bm := element report-definition { 
  $bm/@*[not(name()='name')], 
  attribute name {'CopyOfCookies'}, 
  $bm/* 
} 
return do insert $copy_bm as last into $topath 

<>

doc("testdoc.SF.2642003.xml") 
<>

pf:del-doc("testdoc.SF.2642003.xml")
