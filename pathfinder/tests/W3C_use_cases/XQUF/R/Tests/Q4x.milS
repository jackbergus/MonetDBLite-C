module(unix);
module(pathfinder);

xquery("xml","doc(\"users.xml\")").printf();
fflush(stdout());
fflush(stderr());

xquery("xml","
for $user in
doc(\"users.xml\")/users/user_tuple
return ( $user , $user/rating )
").printf();
fflush(stdout());
fflush(stderr());

xquery("xml","
do insert
    <rating> </rating>
as last into exactly-one(for $ut in doc(\"users.xml\")/users/user_tuple where $ut/name = \"Annabel Lee\" return $ut)
").printf();
fflush(stdout());
fflush(stderr());

xquery("xml","doc(\"users.xml\")").printf();
fflush(stdout());
fflush(stderr());

xquery("xml","
for $user in
doc(\"users.xml\")/users/user_tuple
return ( $user , $user/rating )
").printf();
fflush(stdout());
fflush(stderr());

xquery("xml","
let $user := 
doc(\"users.xml\")/users/user_tuple[name=\"Annabel Lee\"]
return 
  do replace value of exactly-one($user/rating) with \"B\"
").printf();
fflush(stdout());
fflush(stderr());

xquery("xml","doc(\"users.xml\")").printf();
fflush(stdout());
fflush(stderr());
