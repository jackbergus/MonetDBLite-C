stdout of test 'createcoll1_frag` in directory 'modules/pftijah` itself:


# 20:39:37 >  
# 20:39:37 >  Mtimeout -timeout 60 Mserver "--config=/local/rodeh/monet/etc/MonetDB.conf" --debug=0 --set "monet_mod_path=/local/rodeh/monet/lib/MonetDB4:/local/rodeh/monet/lib/MonetDB4/lib:/local/rodeh/monet/lib/MonetDB4/bin" --set "gdk_dbfarm=/local/rodeh/monet/var/MonetDB4/dbfarm" --set "sql_logdir=/local/rodeh/monet/var/MonetDB4/sql_logs" --set "xquery_logdir=/local/rodeh/monet/var/MonetDB4/xquery_logs" --set mapi_port=35761 --set xrpc_port=41445 --set monet_prompt= --trace --dbname=mTests_modules_pftijah  < createcoll1_frag.milS
# 20:39:37 >  

# Monet Database Server V4.16.1
# Copyright (c) 1993-2007, CWI. All rights reserved.
# Compiled for x86_64-suse-linux/64bit with 32bit OIDs; dynamically linked.
# Visit http://monetdb.cwi.nl/ for further information.
module(pftijah);
module(unix);

# should run if you set TSTTRGDIR to pwd
var path:=getenv("TSTSRCDIR");

var coll_opt := new(str,str);
coll_opt.insert("stemmer","snowball-english");
coll_opt.insert("fragmentSize","10");

# index collection at once
var docs := new(str,str);
docs.insert(path+"/xml-docs/dilbert.xml","dilbert.xml");
docs.insert(path+"/xml-docs/dilbert2.xml","dilbert2.xml");
docs.insert(path+"/xml-docs/special.xml","special.xml");
tj_init_collection("coll1_frag", coll_opt);
tj_add2collection("coll1_frag",docs,true);
# Elapsed time = 708us [012us/node]
# Shredded 1 XML document (dilbert.xml), total time after commit=0.007s
# Elapsed time = 571us [009us/node]
# Shredded 1 XML document (dilbert2.xml), total time after commit=0.005s
# Elapsed time = 551us [025us/node]
# Shredded 1 XML document (special.xml), total time after commit=0.005s

# index collection incrementally
tj_init_collection("coll2_frag", coll_opt);
tj_add2collection("coll2_frag",path+"/xml-docs/dilbert.xml","dilbert.xml",true);
tj_add2collection("coll2_frag",path+"/xml-docs/dilbert2.xml","dilbert2.xml",true);
tj_add2collection("coll2_frag",path+"/xml-docs/special.xml","special.xml",true);

coll_opt.replace("fragmentSize","60");

# index collection at once
tj_init_collection("coll1_frag100", coll_opt);
tj_add2collection("coll1_frag100",docs,true);

# index collection incrementally
tj_init_collection("coll2_frag100", coll_opt);
tj_add2collection("coll2_frag100",path+"/xml-docs/dilbert.xml","dilbert.xml",true);
tj_add2collection("coll2_frag100",path+"/xml-docs/dilbert2.xml","dilbert2.xml",true);
tj_add2collection("coll2_frag100",path+"/xml-docs/special.xml","special.xml",true);

# compare indexed collections
var tids := bat("tj_globalTerms").sort().kunique().hmark(0@0);
var coll1 := indexfetchjoin(tids, bat("tj_coll1_frag_TermIndex"), bat("tj_coll1_frag_Terms"));
var coll2 := indexfetchjoin(tids, bat("tj_coll2_frag_TermIndex"), bat("tj_coll2_frag_Terms"));
var coll3 := indexfetchjoin(tids, bat("tj_coll1_frag100_TermIndex"), bat("tj_coll1_frag100_Terms"));
var coll4 := indexfetchjoin(tids, bat("tj_coll2_frag100_TermIndex"), bat("tj_coll2_frag100_Terms"));

diff(coll1,coll2).print();
#-----------------#
# h	t	  # name
# oid	oid	  # type
#-----------------#
diff(coll2,coll3).print();
#-----------------#
# h	t	  # name
# oid	oid	  # type
#-----------------#
diff(coll3,coll4).print();
#-----------------#
# h	t	  # name
# oid	oid	  # type
#-----------------#
quit();

# 20:39:37 >  
# 20:39:37 >  Done.
# 20:39:37 >  

