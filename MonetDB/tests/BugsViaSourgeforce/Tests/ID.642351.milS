
# Date:		2002-11-22 17:08
# Category: 	None
# Group: 	None
# Status: 	Open
# Resolution: 	None
# Priority: 	5
# Submitted By: Maurice van Keulen (mvankeulen)
# Assigned to: 	Nobody/Anonymous (nobody)
# Summary: 	Bug in kintersect
# 
# Initial Comment:
# Sporadically, a bug in "kintersect" is haunting me. The
# result of the operation is not correct. I finally
# managed to construct an example that reproduces the
# bug. The attached file contains two exported bats and a
# small script that imports them and performs a
# kintersect. The result should be empty, but somehow one
# element ends up in the result anyway. To make the bug
# visible, I try to look up the elements of the result in
# one of the operands of kintersect. Since it is an
# intersection, those values should always be there,
# shouldn't they?

module("unix");module("ascii_io");
var TTD := getenv("TSTTRGDIR");

var b:=new(oid,str);
b.import(TTD + "/ID.642351.b.txt");
b.print();
var c:=new(oid,oid);
c.import(TTD + "/ID.642351.c.txt");
c.print();
var d:=c.kintersect(b);
d.print();
d@batloop() { b.find($h).print(); }

var DBGMSK := debugmask();
debugmask(or(DBGMSK,2097152));
var e:=c.kintersect(b);
debugmask(DBGMSK);
e.print();
e@batloop() { b.find($h).print(); }
