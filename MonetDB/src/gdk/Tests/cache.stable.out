stdout of test 'cache` in directory 'src/gdk` itself:


# 11:55:17 >  
# 11:55:17 >  Mtimeout -timeout 60 Mserver "--config=/data/home/boncz/gcc-64-32-debug/etc/MonetDB.conf" --debug=10 --set "monet_mod_path=/data/home/boncz/gcc-64-32-debug/lib/MonetDB:/data/home/boncz/gcc-64-32-debug/lib/bin" --set "gdk_dbfarm=/data/home/boncz/gcc-64-32-debug/var/MonetDB/dbfarm" --set "sql_logdir=/data/home/boncz/gcc-64-32-debug/var/MonetDB/log" --set mapi_port=37376 --set monet_prompt= --trace --dbname=mTests_src_gdk  < cache.milM
# 11:55:17 >  

# Monet Database Server V4.11.3
# Copyright (c) 1993-2006, CWI. All rights reserved.
# Compiled for x86_64-redhat-linux-gnu/64bit with 32bit OIDs; dynamically linked.
# Visit http://monetdb.cwi.nl/ for further information.
module(alarm);

proc test_batcache(int n, int r) : void {
  var b := bat(void,void);
  var j := 0;
  while(j < r) {
    {
      var bb := bat(int,bat,3*n);
      var i := 0;
      while(i < n) {
        var ht := i % 11;
        var tt := (i/11) % 11;
        var v := str(i);
        var vh := b;
        var vt := b;
        if (ht != bat) vh := v.cast(ht);
        if (tt != bat) vt := v.cast(tt);
        var bn := bat(ht,tt).insert(vh, vt).access(BAT_READ);
        var bh := bn.hmark(0@0); # create some views
        var bt := bn.tmark(0@0); # create some views
        bb.insert(i,bn);
        bb.insert(i,bh);
        bb.insert(i,bt);
        i :+= 1;
      }
    }
    # bb destroyed => flush 3*n bats through the cache
    var i := 0;
    while(i < n) {
      var ht := i % 11;
      var tt := (i/11) % 11;
      var v := str(i);
      var vh := b;
      var vt := b;
      if (ht != bat) vh := v.cast(ht);
      if (tt != bat) vt := v.cast(tt);
      var bn := bat(ht,tt).insert(vh, vt).access(BAT_READ);
      var bh := bn.hmark(0@0);
      var bt := bn.tmark(0@0);
      i :+= 1;
    }
    j :+= 1;
  }
}
debugmask(0);
dir();
#-----------------------------------------------------------------------------------------------------------------#
# name			htype	ttype	count	heat	dirty		status	kind	refcnt	lrefcnt		  # name
# str			str	str	lng	int	str		str	str	int	int		  # type
#-----------------------------------------------------------------------------------------------------------------#
[ "MMO_location",	  "oid",  "str",  4,	  0,	  "clean",	  "disk", "pers", 0,	  1		  ]
[ "adm_atomtbl",	  "str",  "int",  13,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "adm_fcntbl",		  "str",  "oid",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_environment",	  "str",  "str",  29,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_aut",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_cnt",	  "oid",  "int",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_dat",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_dsc",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_fcn",	  "oid",  "ptr",  671,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_imp",	  "oid",  "ptr",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_mid",	  "oid",  "oid",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_nme",	  "oid",  "str",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_pro",	  "oid",  "str",  1945,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_sig",	  "oid",  "str",  39,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_tpe",	  "oid",  "int",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_atm",	  "oid",  "str",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_cnt",	  "oid",  "int",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_dep",	  "oid",  "str",  9,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_drop",	  "oid",  "int",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_hdl",	  "oid",  "ptr",  9,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_load",	  "oid",  "str",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_nme",	  "oid",  "str",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_proc",	  "str",  "oid",  98,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_use",	  "oid",  "int",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_var",	  "str",  "ptr",  52,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_unicode_case",	  "int",  "int",  732,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
test_batcache(100,300);

var t := time();
test_batcache(100,300);
var t1 := time() - t;
dir();
#-----------------------------------------------------------------------------------------------------------------#
# name			htype	ttype	count	heat	dirty		status	kind	refcnt	lrefcnt		  # name
# str			str	str	lng	int	str		str	str	int	int		  # type
#-----------------------------------------------------------------------------------------------------------------#
[ "MMO_location",	  "oid",  "str",  4,	  0,	  "clean",	  "disk", "pers", 0,	  1		  ]
[ "adm_atomtbl",	  "str",  "int",  13,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "adm_fcntbl",		  "str",  "oid",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_environment",	  "str",  "str",  29,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_aut",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_cnt",	  "oid",  "int",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_dat",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_dsc",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_fcn",	  "oid",  "ptr",  671,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_imp",	  "oid",  "ptr",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_mid",	  "oid",  "oid",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_nme",	  "oid",  "str",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_pro",	  "oid",  "str",  1945,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_sig",	  "oid",  "str",  39,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_tpe",	  "oid",  "int",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_atm",	  "oid",  "str",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_cnt",	  "oid",  "int",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_dep",	  "oid",  "str",  9,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_drop",	  "oid",  "int",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_hdl",	  "oid",  "ptr",  9,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_load",	  "oid",  "str",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_nme",	  "oid",  "str",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_proc",	  "str",  "oid",  98,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_use",	  "oid",  "int",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_var",	  "str",  "ptr",  52,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_unicode_case",	  "int",  "int",  732,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]

bbp_batcache_minsize(0LL);
t := time();
test_batcache(100,300);
var t2 := time() - t;
dir();
#-----------------------------------------------------------------------------------------------------------------#
# name			htype	ttype	count	heat	dirty		status	kind	refcnt	lrefcnt		  # name
# str			str	str	lng	int	str		str	str	int	int		  # type
#-----------------------------------------------------------------------------------------------------------------#
[ "MMO_location",	  "oid",  "str",  4,	  0,	  "clean",	  "disk", "pers", 0,	  1		  ]
[ "adm_atomtbl",	  "str",  "int",  13,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "adm_fcntbl",		  "str",  "oid",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_environment",	  "str",  "str",  29,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_aut",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_cnt",	  "oid",  "int",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_dat",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_dsc",	  "oid",  "str",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_fcn",	  "oid",  "ptr",  671,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_imp",	  "oid",  "ptr",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_mid",	  "oid",  "oid",  712,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_nme",	  "oid",  "str",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_pro",	  "oid",  "str",  1945,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_sig",	  "oid",  "str",  39,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_fcn_tpe",	  "oid",  "int",  770,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_atm",	  "oid",  "str",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_cnt",	  "oid",  "int",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_dep",	  "oid",  "str",  9,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_drop",	  "oid",  "int",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_hdl",	  "oid",  "ptr",  9,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_load",	  "oid",  "str",  0,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_nme",	  "oid",  "str",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_proc",	  "str",  "oid",  98,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_use",	  "oid",  "int",  19,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_mod_var",	  "str",  "ptr",  52,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
[ "monet_unicode_case",	  "int",  "int",  732,	  0,	  "dirty",	  "load", "tran", 1,	  1		  ]
print(t1 < t2);
[ true ]
quit();

# 11:55:32 >  
# 11:55:32 >  Done.
# 11:55:32 >  

