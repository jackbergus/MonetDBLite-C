.\" Process this file with
.\" groff -man -Tascii foo.1
.\"
.TH MONETDB 1 "SEPTEMBER 2007" Application "MonetDB Applications"
.SH NAME
monetdb \- control a MonetDB Database Server instance
.SH SYNOPSIS
.B monetdb
command [command_options] [command_args]
.SH DESCRIPTION
.B monetdb
allows an administrator of the MonetDB Database Server to perform
various operations on the databases in the server.  It relies on
.BR merovingian (1)
running in the background for starting and stopping databases.
.SH COMMANDS
The commands for the
.B monetdb
utility are
.B create, destroy, lock, release, status, start, stop, kill, help, version.
The commands facilitate adding, removing, maintaining, starting and
stopping a database inside the MonetDB Database Server.
.IP "create [\-l] database"
Initialises a new database in the MonetDB Database Server.  A database
created with this command makes it available for use by clients under
its database name.
.IP \-l
The
.I \-l
(lock) option, puts the database in maintenance mode directly after
its creation.  A database created like this is guaranteed not to be
automatically started by
.BR merovingian (1)
upon a client request during its creation time.
.IP "destroy [\-f] database"
Removes the given database, including all its data and logfiles.  Once
destroy has completed, all data is lost.  Be careful when using this
command.
.IP \-f
By default, a confirmation question is asked, however the
.I \-f
option, when provided, suppresses this question and removal is executed
right away.  Note that you cannot destroy a running database, bring it
down first using the
.B stop
command.
.IP "lock database"
Puts the given database in maintenance mode.  A database under
maintenance can only be connected to by an administrator account
(by default the 
.I monetdb
account).  A database which is under maintenance is not started
automatically by
.BR merovingian (1)
, the MonetDB Database Server, when clients request for it.  Use the
.B release
command to bring the database back for normal usage.  To start a
database which is under maintenance for administrator access, the
.B start
command can be used.
.IP "release database"
Brings back a database from maintenance mode.  A released database is
available again for normal use by any client, and is started on demand.
Use the
.B lock
command to take a database under maintenance.
.IP "status [\-lc] [database ...]"
Shows the state of the given database(s) or, when none given, all known
databases.  Three modes control the level of detail in the displayed
output.  By default a condensed one-line output per database format is
used.  This output resembles pretty much the output of various
.B XXXstat
functions, and is ideal for quickly gaining an overview of the system
state.
.IP \-c
The
.I \-c
flag shows the most used properties of a database.  This includes the
state of the database (running, crashed, stopped), whether it is under
maintenance or not, the crash averages and uptime statistics.  The crash
average is the number of times the database has crashed over the last 1,
15 or 30 starts.  The lower the average, the healthier the database is.
.IP \-l
Triggered by the
.I \-l
flag, a long listing is used.  This listing spans many rows with on each
row one property and its value separated by a colon (`:').  The long
listing includes all information that is available.
.IP "start [\-aw] [database ...]"
.IP "stop [\-aw] [database ...]"
.IP "kill [\-aw] [database ...]"
Starts, stops or kills the given database(s) or, when
.I \-a
is supplied, all known databases, if the MonetDB Database Server
.BR merovingian (1)
is running.  The
.B kill
command should only be used as last resort for a database that doesn't
respond any more to a
.B stop
command.  Killing a database may result in (partial) data loss.
The
.I \-w
flag causes the command only to return once it knows the required action
was taken.  In other words, it waits for the action to be applied.  This
can be useful when starting large databases that have a long startup
time.  When the
.I \-w
flag is used,
.BR monetdb (1)
will output diagnostic messages if the requested action failed.  When
encountering an error, one should always consult the logfile of
.BR merovingian (1)
for more details.  For the
.B kill
command a diagnostic message indicating the database has crashed is
always emitted, due to the nature of that command.
Note that in combination with
.I \-a
the return code of
.BR monetdb (1)
indicates failure if one of the databases had a failure, even though
other databases were successful.
.IP \-h
.IP "help [command]"
Shows general help, or short help for a given command.
.IP \-v
.IP version
Shows the version of the
.B monetdb
utility.
.SH "RETURN VALUE"
The
.B monetdb
utility returns exit code
.B 0
if it successfully performed the requested command.  An error caused by
user input or database state is indicated by exit code
.B 1.
If an internal error in the utility occurs, exit code
.B 2
is returned.
.SH FILES
.I /etc/monetdb5.conf
.RS
The configuration file for MonetDB, located in the system configuration
directory.  This file can be overridden by setting
.I MONETDB5CONF
in the enviroment.
.SH "SEE ALSO"
.BR merovingian (1)
.\".BR mserver5 (1)
