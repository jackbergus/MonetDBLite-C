# simplified version of ls(): we don't want all columns
module(xtables);

var nme := view_bbp_name();
var prs := nme.semijoin(view_bbp_kind().select("pers"));
var rev := [*](nme.reverse().select(int(nil),-1),-1).reverse();
prs.access(BAT_WRITE); prs.col_name("name"); prs.replace(rev);

var cnt := [oid](view_bbp_count().semijoin(prs.mirror()).col_name("count").reverse().sort()).reverse();
var htpe := [oid](view_bbp_htype().semijoin(prs.join(nme.reverse())).col_name("htype").reverse()).reverse();
var ttpe := [oid](view_bbp_ttype().semijoin(prs.join(nme.reverse())).col_name("ttype").reverse()).reverse();

var order := CTrefine(cnt, htpe);
order := CTrefine(order, ttpe);

table(1, order, htpe, ttpe, cnt);
quit();
