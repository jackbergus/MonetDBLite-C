@echo off

if not "%1"=="" goto skip
call %0 -rq
goto :EOF

:skip

setlocal

set pkg=clients
set buildbase=@XBUILD@
set srcdir=@XSOURCE@

rem binaries (.exe)
set PATH=%buildbase%\clients\examples\C;%PATH%
set PATH=%buildbase%\clients\mapiclient;%PATH%
set PATH=%buildbase%\clients\odbc\samples;%PATH%
set PATH=%buildbase%\testing;%PATH%

rem libraries (.dll)
set PATH=%buildbase%\clients\mapilib;%PATH%
set PATH=%buildbase%\clients\perl\Cimpl;%PATH%
set PATH=%buildbase%\common\stream;%PATH%

set PYTHONPATH=%buildbase%\clients\python\build\lib;%buildbase%\testing;%srcdir%\testing;%PYTHONPATH%

set CLASSPATH=%buildbase%\java;%buildbase%\java\tests;%CLASSPATH%

set perlib=%buildbase%\clients\perl;%srcdir%\clients\perl
set PERLLIB=%perlib%;%PERLLIB%
set PERL5LIB=%perlib%;%PERL5LIB%

rem execute Mtest.py in the source directory
pushd "%srcdir%"

call "%buildbase%\testing\Mtest.py" "--package=%pkg%" "--dbfarm=%buildbase%\%pkg%\dbfarm" "--TSTTRGBASE=%buildbase%\%pkg%" %1 %2 %3 %4 %5 %6 %7 %8 %9

popd
endlocal
