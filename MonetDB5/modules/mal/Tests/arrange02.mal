# create sorted oid arrangement 
include orderidx;

bv:= bat.new(:oid,:int);
barrier v:= 0:int;
    w:= mmath.rand();
    bat.append(bv,w);
    redo v:= iterator.next(1:int,10:int);
exit v;

vv:= algebra.slice(bv,0,10);

s0:= algebra.subselect(vv,nil:bat[:oid,:oid],nil:int,nil:int,false,false,false);
io.print(s0,vv);

s1:= algebra.subselect(vv,nil:bat[:oid,:oid],nil:int,846930886,true,true,false);
io.print(s1,vv);

s2:= algebra.subselect(vv,nil:bat[:oid,:oid],846930886,846930886,true,true,false);
io.print(s2,vv);

s3:= algebra.subselect(vv,nil:bat[:oid,:oid],1649760492,nil:int,true,true,false);
io.print(s3,vv);

# introduce an oid index, it should produce the same results
bat.arrange(bv,3);
ord := bat.getorder(bv);
io.print(ord,vv);

x0:= algebra.subselect(vv,nil:bat[:oid,:oid],nil:int,nil:int,false,false,false);
io.print(x0,vv);

x1:= algebra.subselect(vv,nil:bat[:oid,:oid],nil:int,846930886,true,true,false);
io.print(x1,vv);

x2:= algebra.subselect(vv,nil:bat[:oid,:oid],846930886,846930886,true,true,false);
io.print(x2,vv);

x3:= algebra.subselect(vv,nil:bat[:oid,:oid],1649760492,nil:int,true,true,false);
io.print(x3,vv);


