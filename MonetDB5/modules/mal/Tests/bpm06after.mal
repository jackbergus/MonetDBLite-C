bpm.open();
#bpm.dump();

function user.pr(Ra:bat[:any_1,:any_2]):void;
barrier Rp:= bpm.newIterator(Ra);
    io.print(Rp);
    redo Rp:= bpm.hasMoreElements(Ra);
exit Rp;
end pr;
#check content of the partitions
f:bat[:oid,:flt]:=bpm.take("myflt");
user.pr(f);
r:bat[:oid,:sht]:=bpm.take("myR");
user.pr(r);

function user.partinfo(Ra:bat[:any_1,:any_2]):void;
barrier Rp:= bpm.newIterator(Ra);
	Ri:= bat.info(Rp);
	io.print(Ri);
	redo Rp:= bpm.hasMoreElements(Ra);
exit Rp;
end partinfo;

#user.partinfo(f);
bpm.discard(f);

#user.partinfo(r);
bpm.discard(r);

bpm.saveCatalog();
#io.print("after cleanup");
#bpm.dump();
