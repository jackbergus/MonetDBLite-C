#testing the BAT partition manager
# use a fake sql library
module sql;
pattern bind(s:str,t:str,i:str,flag:int):bat[:oid,:int]
address MALLISTnew;
pattern rsColumn(b:any...):void
address MALLISTnew;
pattern resultSet(b:any...):void
address MALLISTnew;
pattern exportResult(b:any...):void
address MALLISTnew;

function query();
    t1:bat[:oid,:int]:= sql.bind("sys","t","i",0);
    t11:= algebra.markT(t1,0@0);
    t12:= bat.reverse(t11);
    t13:= algebra.join(t12,t1);
    t14 := sql.resultSet(1,1,t13);
    sql.rsColumn(t14,"sys.t","i","int",32,0,t13);
    sql.exportResult(t14,"");
end query;
optimizer.partitions("sql","query");
mdb.list("sql","query");
