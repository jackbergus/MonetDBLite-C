# for testweb, we need to ask the server itself how it is available, use
# sabaoth for that
include sabaoth;

h := sabaoth.getLocalConnectionHost();
p := sabaoth.getLocalConnectionPort();

# create a connecton to ourself
conn:rmtconn := remote.create(h, p, nil:str, "monetdb", "monetdb");

a:str := "Fabian!";
b:flt := 4.3;
c:int := 12;
d:bat[:str,:int] := bat.new(:str, :int);
bat.insert(d, "bla", 1);
bat.insert(d, nil:str, 2);
bat.insert(d, "boe", nil:int);

# store the values
i:rmtobj := remote.put(conn, a);
j:rmtobj := remote.put(conn, b);
k:rmtobj := remote.put(conn, c);
l:rmtobj := remote.put(conn, d);

# retrieve the value
r:str := remote.get(conn, i);
s:flt := remote.get(conn, j);
t:int := remote.get(conn, k);
u:bat[:str,:int] := remote.get(conn, l);

# see if it really is here
io.print(r);
io.print(s);
io.print(t);
io.print(u);

# help testweb a bit, since currently no cleanup is done on server
# shutdown
remote.destroy(conn);
