#test clustering a small table
include cluster;
b:= bat.new(:oid,:int);
c:= bat.new(:oid,:int);
barrier (v,i):= language.newRange(0:int);
	j:= i % 5;
	bat.append(b,j);
	j:= i % 3;
	bat.append(c,j);
	redo (v,i):= language.nextElement(1:int,10:int);
exit (v,i);
#bat.append(b,b);
io.print(b,c);

keys := cluster.key(b);
io.print(keys);

map:=cluster.new(keys);
io.print(map);

b1:= algebra.join(map,b);
c1:= algebra.join(map,c);
io.print(b1,c1);

