#testing the Milena BAT partition manager
R := bat.new(:oid,:int);
bat.append(R,1);
bat.append(R,3);
bat.append(R,5);
bat.append(R,7);
bat.append(R,11);

function user.pr(Ra:bat[:any_1,:any_2]):void;
barrier Rp:= bpm.newIterator(Ra);
	io.print(Rp);
	redo Rp:= bpm.hasMoreElements(Ra);
exit Rp;
end pr;

# add the stuff to the BPM and dump it
Ra:= bpm.deposit("myR",R);
user.pr(Ra);

io.print("Vector partition it ");
pv:= bat.new(:oid,:int);
bat.append(pv,0);
bat.append(pv,5);
bat.append(pv,6);
bat.append(pv,nil:int);

bpm.rangePartition(Ra,pv);
bpm.dump();
user.pr(Ra);

io.print("Head vector partition it ");
Rrev:= bat.reverse(Ra);
po:= bat.new(:oid,:oid);
bat.append(po,0@0);
bat.append(po,2@0);
bat.append(po,nil:oid);

bpm.rangePartition(Rrev,po);
bpm.dump();
user.pr(Rrev);

# and what is now the result of this
io.print("And redo tail vector partition ");
pv:= bat.new(:oid,:int);
bat.append(pv,0);
bat.append(pv,3);
bat.append(pv,nil:int);

bpm.rangePartition(Ra,pv);
bpm.dump();
user.pr(Ra);
bpm.discard(Ra);
