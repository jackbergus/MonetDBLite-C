## Test ResultSet on reusability using equal typed BATs

include rsbox;

rs := rsbox.create(1, 't');

resultset.setProperty(rs, 1, "name", "the_column");
resultset.setProperty(rs, 1, "table", "table1");
resultset.setProperty(rs, 1, "schema", "sys");

b1 := bat.new(:void, :str);
bat.insert(b1, nil, "test1");
bat.insert(b1, nil, "test2");
bat.insert(b1, nil, nil:str);
bat.insert(b1, nil, "values");
bat.insert(b1, nil, "whatever");

resultset.populateColumn(rs, 1, b1);

resultset.writeNextPart(rs);


b1 := bat.new(:void, :str);
bat.insert(b1, nil, "Daft Punk - Human After All");
bat.insert(b1, nil, "Spinvis - Spinvis");
bat.insert(b1, nil, "Within Temptation - The Silent Force");
bat.insert(b1, nil, "Anouk - Together Alone");
bat.insert(b1, nil, "Armiral Freebee - Admiral Freebee");
bat.insert(b1, nil, "Lais - Douce Victime");
bat.insert(b1, nil, "Hooverphonic - Sit Down and Listen To...");
bat.insert(b1, nil, "Osdorp Posse - Tegenstrijd");
bat.insert(b1, nil, "MC Wigger & DJ Wanna-B - Fuck Osdorp");

resultset.dePopulate(rs);
resultset.populateColumn(rs, 1, b1);

resultset.writeNextPart(rs);

rsbox.release(rs);
