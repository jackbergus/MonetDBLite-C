## Test ResultSet unionability

include rsbox;

rs := rsbox.create(1, 't');

resultset.setProperty(rs, 1, "name", "the_column");
resultset.setProperty(rs, 1, "table", "the_table");
resultset.setProperty(rs, 1, "schema", "the_schema");

b1 := bat.new(:void, :int);
bat.insert(b1, nil, 1);
bat.insert(b1, nil, 2);
bat.insert(b1, nil, nil:int);
bat.insert(b1, nil, 4);
bat.insert(b1, nil, 6);

resultset.populateColumn(rs, 1, b1);
resultset.addUnion(rs);

b1 := bat.new(:void, :int);
bat.insert(b1, nil, 7);
bat.insert(b1, nil, 8);

resultset.populateColumn(rs, 1, b1);
resultset.addUnion(rs);

b1 := bat.new(:void, :int);
bat.insert(b1, nil, 13);
bat.insert(b1, nil, 23);

resultset.populateColumn(rs, 1, b1);
resultset.writeNextPart(rs);

resultset.dePopulate(rs);

resultset.populateColumn(rs, 1, b1);
resultset.writeNextPart(rs);

rsbox.release(rs);

