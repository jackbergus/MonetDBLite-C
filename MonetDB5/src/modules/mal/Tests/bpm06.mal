#testing the BAT partition manager
# addPartition for incremental addition of partitioned resuls
# saveCatalog for persistency

#First partitioned bat
R := bat.new(:oid,:sht);
bat.append(R,1:sht);
bat.append(R,3:sht);
bat.append(R,5:sht);
bat.append(R,7:sht);
bat.append(R,11:sht);
Ra:= bpm.deposit("myR",R);

io.print("Range partition it ");
pv:= bat.new(:oid,:sht);
bat.append(pv,0:sht);
bat.append(pv,5:sht);

bpm.rangePartition(Ra,pv);
bpm.dump();

function user.pr(Ra:bat[:any_1,:any_2]):void;
barrier Rp:= bpm.newIterator(Ra);
	io.print(Rp);
	redo Rp:= bpm.hasMoreElements(Ra);
exit Rp;
end pr;
user.pr(Ra);

#Second partitioned bat
d:=bat.new(:oid,:flt);
bat.insert(d,1:oid,2.5);
bat.insert(d,2:oid,6.8);
bat.insert(d,5:oid,-1.3);
da:=bpm.deposit("myflt",d);

io.print("Range partition it ");
pd:= bat.new(:oid,:flt);
bat.append(pd,2.3);
bat.append(pd,5.0);
bpm.rangePartition(da,pd);
bpm.dump();
user.pr(da);

bpm.saveCatalog();



