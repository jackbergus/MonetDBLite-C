#testing the BAT partition manager
# addPartition for incremental addition of partitioned resuls
# savePartitions for persistency

d:=bat.new(:oid,:flt);
bat.insert(d,1:oid,2.5);
bat.insert(d,2:oid,6.8);
da:=bpm.deposit("myflt",d);

dd:=bat.new(:oid,:flt);
bat.insert(dd,15:oid,3.5);
bat.insert(dd,20:oid,4.8);
dda:=bpm.addPartition("myflt",dd,10:oid,30:oid,1.0,10.0);

bpm.dump();

function user.partinfo(Ra:bat[:any_1,:any_2]):void;
barrier Rp:= bpm.newIterator(Ra);
	Ri:= bat.info(Rp);
	io.print(Ri);
	redo Rp:= bpm.hasMoreElements(Ra);
exit Rp;
end partinfo;

f:bat[:oid,:flt]:=bpm.take("myflt");
user.partinfo(f);

bpm.savePartitions();



