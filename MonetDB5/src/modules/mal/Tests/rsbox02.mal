## Test ResultSet reusability using hetrogenous typed BATs

include rsbox;

rs := rsbox.create(1, 't');

resultset.setProperty(rs, 1, "name", "the_column");
resultset.setProperty(rs, 1, "table", "table1");
resultset.setProperty(rs, 1, "schema", "sys");

b1 := bat.new(:void, :int);
bat.insert(b1, nil, 1);
bat.insert(b1, nil, 2);
bat.insert(b1, nil, nil:int);
bat.insert(b1, nil, 4);
bat.insert(b1, nil, 6);

resultset.populateColumn(rs, 1, b1);

resultset.writeNextPart(rs);

b2 := bat.new(:void, :str);
bat.insert(b2, nil, "Daft Punk - Human After All");
bat.insert(b2, nil, "Spinvis - Spinvis");
bat.insert(b2, nil, "Within Temptation - The Silent Force");
bat.insert(b2, nil, "Anouk - Together Alone");
bat.insert(b2, nil, "Armiral Freebee - Admiral Freebee");
bat.insert(b2, nil, "Lais - Douce Victime");
bat.insert(b2, nil, "Hooverphonic - Sit Down and Listen To...");
bat.insert(b2, nil, "Osdorp Posse - Tegenstrijd");
bat.insert(b2, nil, "MC Wigger & DJ Wanna-B - Fuck Osdorp");

resultset.dePopulate(rs);
resultset.populateColumn(rs, 1, b2);

resultset.writeNextPart(rs);

rsbox.release(rs);
