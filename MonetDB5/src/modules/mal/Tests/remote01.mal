# for testweb, we need to ask the server itself how it is available, use
# sabaoth for that
include sabaoth;

h := sabaoth.getLocalConnectionHost();
p := sabaoth.getLocalConnectionPort();

# create a connecton to ourself
conn:str := remote.create(h, p, nil:str, "monetdb", "monetdb");

# retrieve a value (that for sure won't exist)
x:void := remote.get(conn, "b1":str);
catch MALException:str;
	io.printf("!%s\n",MALException);
exit MALException;

# should raise an exception (the arguments should make it fail)
i:str := remote.create("localhost", 63000, nil:str, "test", "test");
catch IOException:str;
	# make it a comment, the connection name is always different
	io.printf("#!%s\n",IOException);
exit IOException;

# help testweb a bit, since currently no cleanup is done on server
# shutdown
remote.destroy(conn);

# this should fail now
remote.destroy(conn);
catch MALException:str;
	# make it a comment, the connection name is always different
	io.printf("#!%s\n",MALException);
exit MALException;
