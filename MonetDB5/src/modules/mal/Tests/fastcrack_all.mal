# The first reference case for fast cracking

include microbenchmark;
include crackers;

tuples:= 1; #67108864= 64* 1024*1024
tuples:= tuples * 1024;
tuples:= tuples * 1024;
values:= tuples;
io.printf(" tuples %d\n",tuples);
io.printf(" values %d\n",values);

b0:= microbenchmark.uniform(0@0,tuples,values);
size:= bat.getBatSize(b0);
io.printf(" BAT size %d\n",size);

n:=20;
t_Zero_00:=0:lng;
t_Zero_MK:=0:lng;
t_Zero_SI:=0:lng;
t_Zero_SM:=0:lng;
t_One_MK:=0:lng;
t_One_SI:=0:lng;
t_One_SM:=0:lng;
t_Two_00:=0:lng;
t_Two_MK:=0:lng;
t_Two_SI:=0:lng;
t_Two_SM:=0:lng;
barrier (go,i):= (true,0);
	b0:= microbenchmark.uniform(0@0,tuples,values);
	mid:int:= mmath.rand();
	mid := mid % values;
	low:int:= mmath.rand();
	low := low % values;
	hgh:int:= mmath.rand();
	hgh := hgh % values;
	redo go := low>hgh;
	io.print(mid,low,hgh);

#	b:=algebra.copy(b0);
#t0:= alarm.usec();
#	c:=crackers.crack(b,mid);
#t1:= alarm.usec();
#	time:= t1 - t0;
#	t_Zero_00 := t_Zero_00 + time;
#	v := crackers.zcrack_validate(c,mid);
#	io.print("Zero_00",time,v);
#	crackers.destroy(b);

	b:=algebra.copy(b0);
t0:= alarm.usec();
	c:=crackers.zcrack_MK(b,mid);
t1:= alarm.usec();
	time:= t1 - t0;
	t_Zero_MK := t_Zero_MK + time;
	v := crackers.zcrack_validate(c,mid);
	io.print("Zero_MK",time,v);

#	b:=algebra.copy(b0);
#t0:= alarm.usec();
#	c:=crackers.zcrack_SI(b,mid);
#t1:= alarm.usec();
#	time:= t1 - t0;
#	t_Zero_SI := t_Zero_SI + time;
#	v := crackers.zcrack_validate(c,mid);
#	io.print("Zero_SI",time,v);

	b:=algebra.copy(b0);
t0:= alarm.usec();
	c:=crackers.zcrack_SM(b,mid);
t1:= alarm.usec();
	time:= t1 - t0;
	t_Zero_SM := t_Zero_SM + time;
	v := crackers.zcrack_validate(c,mid);
	io.print("Zero_SM",time,v);


	b:=algebra.copy(b0);
t0:= alarm.usec();
	c:=crackers.crack_MK(b,mid);
t1:= alarm.usec();
	time:= t1 - t0;
	t_One_MK := t_One_MK + time;
	v := crackers.crack_validate(c,mid);
	io.print("One_MK",time,v);

	b:=algebra.copy(b0);
t0:= alarm.usec();
	c:=crackers.crack_SI(b,mid);
t1:= alarm.usec();
	time:= t1 - t0;
	t_One_SI := t_One_SI + time;
	v := crackers.crack_validate(c,mid);
	io.print("One_SI",time,v);

	b:=algebra.copy(b0);
t0:= alarm.usec();
	c:=crackers.crack_SM(b,mid);
t1:= alarm.usec();
	time:= t1 - t0;
	t_One_SM := t_One_SM + time;
	v := crackers.crack_validate(c,mid);
	io.print("One_SM",time,v);


#	b:=algebra.copy(b0);
#t0:= alarm.usec();
#	c:=crackers.crack(b,low,hgh);
#t1:= alarm.usec();
#	time:= t1 - t0;
#	t_Two_00 := t_Two_00 + time;
#	v := crackers.crack_validate(c,low,hgh);
#	io.print("Two_00",time,v);

#	b:=algebra.copy(b0);
#t0:= alarm.usec();
#	c:=crackers.crack_MK(b,low,hgh);
#t1:= alarm.usec();
#	time:= t1 - t0;
#	t_Two_MK := t_Two_MK + time;
#	v := crackers.crack_validate(c,low,hgh);
#	io.print("Two_MK",time,v);

#	b:=algebra.copy(b0);
#t0:= alarm.usec();
#	c:=crackers.crack_SI(b,low,hgh);
#t1:= alarm.usec();
#	time:= t1 - t0;
#	t_Two_SI := t_Two_SI + time;
#	v := crackers.crack_validate(c,low,hgh);
#	io.print("Two_SI",time,v);

#	b:=algebra.copy(b0);
#t0:= alarm.usec();
#	c:=crackers.crack_SM(b,low,hgh);
#t1:= alarm.usec();
#	time:= t1 - t0;
#	t_Two_SM := t_Two_SM + time;
#	v := crackers.crack_validate(c,low,hgh);
#	io.print("Two_SM",time,v);

	redo (go,i):= mal.nextElement(1,n);
exit (go,i);

io.print("");
t_ := t_Zero_00 / n;
io.print("Zero_00",t_);
t_ := t_Zero_MK / n;
io.print("Zero_MK",t_);
t_ := t_Zero_SI / n;
io.print("Zero_SI",t_);
t_ := t_Zero_SM / n;
io.print("Zero_SM",t_);
t_ := t_One_MK / n;
io.print("One_MK",t_);
t_ := t_One_SI / n;
io.print("One_SI",t_);
t_ := t_One_SM / n;
io.print("One_SM",t_);
t_ := t_Two_00 / n;
io.print("Two_00",t_);
t_ := t_Two_MK / n;
io.print("Two_MK",t_);
t_ := t_Two_SI / n;
io.print("Two_SI",t_);
t_ := t_Two_SM / n;
io.print("Two_SM",t_);
