# let connect figure out itself how to connect to the running db
db := const.take("dbname");
conn:str := remote.connect(db, "monetdb", "monetdb");

b := bat.new(:str, :int);
bat.insert(b, "bla", 1);
bat.insert(b, "boe", 2);
bat.insert(b, "foo", 3);
bat.insert(b, "bar", 4);
bat.insert(b, "baz", 5);

k := remote.put(conn, b);
l := remote.put(conn, 3);
m := remote.put(conn, 10);

# perform a selection remote, and get the result back
t := remote.exec(conn, "algebra", "select", k, l, m);
j:bat[:str,:int] := remote.get(conn, t);
io.print(j);

# help testweb a bit, since currently no cleanup is done on server
# shutdown
remote.disconnect(conn);
