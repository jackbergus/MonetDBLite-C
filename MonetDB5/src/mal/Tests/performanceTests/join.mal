# what is the overhead of MAL in multiplex situations
profiler.setFilter("*","*");
b:= bat.new(:oid,:lng);
c:= bat.new(:oid,:lng);
t0:= alarm.usec();
barrier (v,i):= language.newRange(0:lng);
	o:= calc.oid(i);
	r:= mmath.rand();
	rl:= calc.lng(r);
	bat.insert(b,o,i);
	bat.insert(c,o,rl);
	redo (v,i):= language.nextElement(1:lng,10000000:lng);
exit (v,i);
t1:= alarm.usec();
cr := bat.reverse(c);
t2:= alarm.usec();
x:= algebra.join(b,cr);
t3:= alarm.usec();
y:= algebra.join(b,cr);
t4:= alarm.usec();
d1:= t2-t0;
d2:= t3-t2;
d3:= t4-t3;
io.printf("make tables %d \n",d1);
io.printf("join 10Mx10M %d\n",d2);
io.printf("join 10Mx10M %d\n",d3);
