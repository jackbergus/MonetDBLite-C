# the multiplex code blocks.

t0:= alarm.usec();
b:= bat.new(:oid,:lng);
barrier (go,i):= language.newRange(0:lng);
	k:= mmath.rand();
	l:= calc.lng(k);
	bat.insert(b,nil:oid,l);
	redo (go,i):= language.nextElement(1:lng,10000:lng);
exit (go,i);

profiler.activate("ticks");
profiler.activate("statement");
profiler.activate("bytes");
profiler.activate("disk");
profiler.setAll();

profiler.start();
io.printf("#monitor \n");
mx:= aggr.max(b); 
k1:=algebra.select(b,nil:lng,mx); 
k2:=algebra.select(b,mx,nil:lng); 
info:= bat.info(k2);
d:= mmath.sin(0.2:dbl);
profiler.stop();

#stmt:= profiler.getTrace("statement");
#io.print(stmt);
ticks:= profiler.getTrace("ticks");
#io.print(ticks);
rdbytes:= profiler.getTrace("ibytes");
#io.print(rdbytes);
wrbytes:= profiler.getTrace("obytes");
#io.print(wrbytes);
diskspace:= profiler.getTrace("diskspace");
#io.print(diskspace);
io.print(rdbytes,wrbytes);
#io.print(ticks,rdbytes,wrbytes,diskspace);
io.print(info);
