# test the reference counting scheme
b:= bat.new(:int,:int);
bat.insert(b,0,0);
bat.insert(b,1,1);
bat.insert(b,2,2);
bat.insert(b,3,3);

i:= bbp.getLRefCount(b);
io.printf("start of selections %d [1]\n",i);
z:= algebra.select(b,0,2); io.print(z);
i:= bbp.getLRefCount(z);
io.printf("z select %d [1]\n",i);
i:= bbp.getLRefCount(b);
io.printf("select %d [1]\n",i);
z:= algebra.betweenCO(b,0,2); io.print(z);
i:= bbp.getLRefCount(b);
io.printf("select %d [1]\n",i);
z:= algebra.betweenOC(b,0,2); io.print(z);
z:= algebra.betweenOO(b,0,2); io.print(z);
