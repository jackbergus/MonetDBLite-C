# Monet Mil to Mal compiler
include mil;
# Copyright (c) 2001-2004, CWI. All rights reserved.

#Predefined code segment
#The compiler can not guarantee an accurate compilation,
#because MIL unlike MAL is a dynamically typed language.
#A few guidelines to maximize usefullness.
#- make the type of variables explicit, in particular 'nil'
#- upon advice of M2m to remap identifiers, change it in your program directly
#use the "mil_schema" for additional support routines
	mil.line("# >Number:         99\n");
	mil.line("# >Category:       Mserver\n");
	mil.line("# >Synopsis:       comparison of nil values is not reliable\n");
	mil.line("# >Confidential:   no\n");
	mil.line("# >Severity:       critical\n");
	mil.line("# >Priority:       high\n");
	mil.line("# >Responsible:    boncz\n");
	mil.line("# >State:          open\n");
	mil.line("# >Class:          sw-bug\n");
	mil.line("# >Submitter-Id:   unknown\n");
	mil.line("# >Arrival-Date:   Mon Dec 15 11:22:32 1997\n");
	mil.line("# >Originator:     windhouw\n");
	mil.line("# >Organization:\n");
	mil.line("# UvA\n");
	mil.line("# >Release:        971007\n");
	mil.line("# >Environment:\n");
	mil.line("# \n");
	mil.line("# >Description:\n");
	mil.line("# #You are system administrator (adm)!\n");
	mil.line("# >PROC comp( any left, any right) : any {\n");
	mil.line("# >  IF (left = right) {\n");
	mil.line("# >    printf(\"left equals right\\n\");\n");
	mil.line("# >  } ELSE {\n");
	mil.line("# >    printf(\"left is not equal to right\\n\");\n");
	mil.line("# >  }\n");
	mil.line("# >  IF (left != right) {\n");
	mil.line("# >    printf(\"left is not equal to right\\n\");\n");
	mil.line("# >  } ELSE {\n");
	mil.line("# >    printf(\"left equals right\\n\");\n");
	mil.line("# >  }\n");
	mil.line("# >}\n");
	mil.line("# >comp(oid(nil),oid(nil));\n");
	mil.line("# left equals right\n");
	mil.line("# left is not equal to right\n");
	mil.line("# >comp(oid(1),oid(nil));\n");
	mil.line("# left is not equal to right\n");
	mil.line("# left is not equal to right\n");
	mil.line("# >comp(oid(1),oid(1));\n");
	mil.line("# left equals right\n");
	mil.line("# left equals right\n");
	mil.line("# >comp(str(nil),str(nil));\n");
	mil.line("# left equals right\n");
	mil.line("# left is not equal to right\n");
	mil.line("# >comp(str(\"a\"),str(nil));\n");
	mil.line("# left equals right\n");
	mil.line("# left is not equal to right\n");
	mil.line("# >comp(str(\"a\"),str(\"a\"));\n");
	mil.line("# left equals right\n");
	mil.line("# left equals right\n");
	mil.line("setoid(oid(20000000));");
	aa_a := calc.oid(20000000);
	ba_a := setoid(aa_a);
	mil.line("PROC comp(any left, any right) : any {");
function comp(left:any$1, right:any$2):any$3;
	mil.line("  IF (left = right) {");
barrier	ca_a := ==(left,right);
	mil.line("    printf(\"left equals right\\n\");");
	da_a := printf("left equals right\n");
	mil.line("  } ELSE {");
exit	ca_a;
barrier	ea_a := not(ca_a);
	mil.line("    printf(\"left is not equal to right\\n\");");
	fa_a := printf("left is not equal to right\n");
exit	ea_a;
	mil.line("  IF (left != right) {");
barrier	ga_a := !=(left,right);
	mil.line("    printf(\"left is not equal to right\\n\");");
	ha_a := printf("left is not equal to right\n");
	mil.line("  } ELSE {");
exit	ga_a;
barrier	ia_a := not(ga_a);
	mil.line("    printf(\"left equals right\\n\");");
	ja_a := printf("left equals right\n");
exit	ia_a;
end comp;
	mil.line("comp(oid(nil),oid(nil));");
	ka_a := calc.oid(nil);
	la_a := calc.oid(nil);
	ma_a := comp(ka_a,la_a);
	mil.line("comp(oid(1),oid(nil));");
	na_a := calc.oid(1);
	oa_a := calc.oid(nil);
	pa_a := comp(na_a,oa_a);
	mil.line("comp(oid(1),oid(1));");
	qa_a := calc.oid(1);
	ra_a := calc.oid(1);
	sa_a := comp(qa_a,ra_a);
	mil.line("comp(str(nil),str(nil));");
	ta_a := calc.str(nil);
	ua_a := calc.str(nil);
	va_a := comp(ta_a,ua_a);
	mil.line("comp(str(\"a\"),str(nil));");
	wa_a := str("a");
	xa_a := calc.str(nil);
	ya_a := comp(wa_a,xa_a);
	mil.line("comp(str(\"a\"),str(\"a\"));");
	ab_a := str("a");
	bb_a := str("a");
	cb_a := comp(ab_a,bb_a);
	mil.line("quit();");
	db_a := clients.quit();
