#                                               -*- Autoconf -*-
#                                               vim: ft=config :

dnl The contents of this file are subject to the MonetDB Public License
dnl Version 1.1 (the "License"); you may not use this file except in
dnl compliance with the License. You may obtain a copy of the License at
dnl http://monetdb.cwi.nl/Legal/MonetDBLicense-1.1.html
dnl
dnl Software distributed under the License is distributed on an "AS IS"
dnl basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
dnl License for the specific language governing rights and limitations
dnl under the License.
dnl
dnl The Original Code is the MonetDB Database System.
dnl
dnl The Initial Developer of the Original Code is CWI.
dnl Portions created by CWI are Copyright (C) 1997-July 2008 CWI.
dnl Copyright August 2008-2011 MonetDB B.V.
dnl All Rights Reserved.

# Process this file with autoconf to produce a configure script.

AC_PREREQ(2.60)
AC_INIT([MonetDB Buildtools], 1.0, info@monetdb.org)
AM_INIT_AUTOMAKE([MonetDB], [1.0])

AC_PROG_INSTALL
AC_PATH_PROGS([PYTHON], [python python2 python2.3 python2.4],
			  [AC_ERROR(No python could be found in your path)])

AC_ARG_ENABLE(mel,
	AS_HELP_STRING([--enable-mel], 
		[mel is only needed for MonetDB4]),
	[enable_mel=$enableval],[enable_mel="yes"])

case $enable_mel in
yes)
	# HACK: because autoconf doesn't want to run configure with "added
	# arguments", we just call it ourselves here.  Pretty dirty, I know.

	(test -d mel || mkdir mel ; cd mel && eval "`cd .. && cd ${srcdir} && pwd`/mel/configure ${ac_configure_args} --with-mx=../Mx/Mx")
	;;
esac
AM_CONDITIONAL([ENABLE_MEL], [test "$enable_mel" = yes])

AC_ARG_ENABLE(burg,
	AS_HELP_STRING([--enable-burg], 
		[Burg is only needed for MonetDB/XQuery]),
	[enable_burg=$enableval],[enable_burg="yes"])

AM_CONDITIONAL([ENABLE_BURG], [test "$enable_burg" = yes])


AC_CONFIG_FILES([Makefile autogen/Makefile conf/Makefile conf/Mbootstrap
                 conf/buildtools-config])
AM_CONFIG_HEADER([dummy.h])

AC_SUBST([PYTHON])

AC_CONFIG_SUBDIRS([Mx])
if test x"$enable_burg" = x"yes" ; then
	AC_CONFIG_SUBDIRS([burg])
fi

AC_OUTPUT
