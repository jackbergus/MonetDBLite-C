stdout of test 'modrefcnt2` in directory 'monet` itself:


# 18:26:29 >  
# 18:26:29 >  Mtimeout -timeout 240 Mserver "--config=/var/tmp/_4.3.13-FixedPetersDDsync_PREFIX_MONET_GNU_32_d_--enable-warning_/etc/monet.conf" --debug=10 --set "monet_mod_path=/var/tmp/_4.3.13-FixedPetersDDsync_PREFIX_MONET_GNU_32_d_--enable-warning_/lib/MonetDB" --set "gdk_dbfarm=/var/tmp/_4.3.13-FixedPetersDDsync_PREFIX_MONET_GNU_32_d_--enable-warning_/var/MonetDB/dbfarm" --set "sql_logdir=/var/tmp/_4.3.13-FixedPetersDDsync_PREFIX_MONET_GNU_32_d_--enable-warning_/var/MonetDB/log" --set mapi_port=53708 --set sql_port=52024 --set monet_prompt= --trace "--dbname=mTests_src_monet" "/var/tmp/_4.3.13-FixedPetersDDsync_PREFIX_MONET_GNU_32_d_--enable-warning_/lib/MonetDB/mapi.mil" modrefcnt2.prologue ; echo ; echo Over..
# 18:26:29 >  

# Monet Database Server V4.3.13
# Copyright (c) 1993-2004, CWI. All rights reserved.
# compiled for i686-pc-linux-gnu/32bit; dynamically linked.
#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "lock",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]
#---------------------------------#
# signature			  #
#---------------------------------#
[ "lock_create() : lock"	  ]
[ "lock_destroy(lock) : void"	  ]
[ "lock_set(lock) : void"	  ]
[ "lock_try(lock) : int"	  ]
[ "lock_unset(lock) : void"	  ]
[ "sema_create(int) : sema"	  ]
[ "sema_destroy(sema) : void"	  ]
[ "sema_down(sema) : void"	  ]
[ "sema_up(sema) : void"	  ]
#-----------------#
# BAT:	  test	  #
# (int)	  (lock)  #
#-----------------#
[ 0 ]
printf("\nReady.\n");

Ready.
# in the global context on the Mserver konsole (after all clients are gone):

loaded();
#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "lock",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]
sigs("lock");
#---------------------------------#
# signature			  #
#---------------------------------#
[ "lock_create() : lock"	  ]
[ "lock_destroy(lock) : void"	  ]
[ "lock_set(lock) : void"	  ]
[ "lock_try(lock) : int"	  ]
[ "lock_unset(lock) : void"	  ]
[ "sema_create(int) : sema"	  ]
[ "sema_destroy(sema) : void"	  ]
[ "sema_down(sema) : void"	  ]
[ "sema_up(sema) : void"	  ]
bat("test").print();
#-----------------#
# BAT:	  test	  #
# (int)	  (lock)  #
#-----------------#
bat("test").count().print();
[ 0 ]

drop("lock");
!ERROR: unloadmod_check_use: drop(_lock) failed: test[int,lock] has 1 reference.
loaded();
#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "_lock",	  1		  ]
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]
sigs("lock");
!ERROR: sigs: must load module first.
;
printf("\nDone..\n");

Done..
quit();

Over..

# 15:23:57 >  
# 15:23:57 >  Mtimeout -timeout 60 MapiClient "--config=/var/tmp/_PREFIX_MONET_GNU_32_d__/etc/monet.conf" --host=draco --port=53745 < modrefcnt2_s00.milC
# 15:23:57 >  

#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]
#---------------------------------#
# signature			  # name
# str				  # type
#---------------------------------#
[ "lock_create() : lock"	  ]
[ "lock_destroy(lock) : void"	  ]
[ "lock_set(lock) : void"	  ]
[ "lock_try(lock) : int"	  ]
[ "lock_unset(lock) : void"	  ]
[ "sema_create(int) : sema"	  ]
[ "sema_destroy(sema) : void"	  ]
[ "sema_down(sema) : void"	  ]
[ "sema_up(sema) : void"	  ]


# 22:59:33 >  
# 22:59:33 >  Mtimeout -timeout 60 MapiClient "--config=/var/tmp/_PREFIX_MONET_GNU_32_d__/etc/monet.conf" --host=draco --port=54354 < modrefcnt2_s01.milC
# 22:59:33 >  

#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "lock",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]
#---------------------------------#
# signature			  #
#---------------------------------#
[ "lock_create() : lock"	  ]
[ "lock_destroy(lock) : void"	  ]
[ "lock_set(lock) : void"	  ]
[ "lock_try(lock) : int"	  ]
[ "lock_unset(lock) : void"	  ]
[ "sema_create(int) : sema"	  ]
[ "sema_destroy(sema) : void"	  ]
[ "sema_down(sema) : void"	  ]
[ "sema_up(sema) : void"	  ]
#-----------------#
# BAT:	  test	  #
# (int)	  (lock)  #
#-----------------#
[ 0	]

# 18:26:30 >  
# 18:26:30 >  Mtimeout -timeout 60 MapiClient "--config=/var/tmp/_4.3.13-FixedPetersDDsync_PREFIX_MONET_GNU_32_d_--enable-warning_/etc/monet.conf" --host=draco --port=53708 < modrefcnt2_s02.milC
# 18:26:30 >  

#---------------------------------#
# module	| usage_count	  #
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]


#---------------------------------#
# signature			  # name
# str				  # type
#---------------------------------#
[ "lock_create() : lock"	  ]
[ "lock_destroy(lock) : void"	  ]
[ "lock_set(lock) : void"	  ]
[ "lock_try(lock) : int"	  ]
[ "lock_unset(lock) : void"	  ]
[ "sema_create(int) : sema"	  ]
[ "sema_destroy(sema) : void"	  ]
[ "sema_down(sema) : void"	  ]
[ "sema_up(sema) : void"	  ]
#---------------------------------#
# module		usage_count	  # name
# str		int		  # type
#---------------------------------#
[ "algebra",	  1		  ]
[ "arith",	  1		  ]
[ "bat",	  1		  ]
[ "builtin",	  1		  ]
[ "constant",	  1		  ]
[ "main",	  1		  ]
[ "mapi",	  1		  ]
[ "str",	  1		  ]
[ "streams",	  1		  ]
[ "sys",	  1		  ]
[ "trans",	  1		  ]
#---------------------------------#
# signature			  # name
# str				  # type
#---------------------------------#
[ "lock_create() : lock"	  ]
[ "lock_destroy(lock) : void"	  ]
[ "lock_set(lock) : void"	  ]
[ "lock_try(lock) : int"	  ]
[ "lock_unset(lock) : void"	  ]
[ "sema_create(int) : sema"	  ]
[ "sema_destroy(sema) : void"	  ]
[ "sema_down(sema) : void"	  ]
[ "sema_up(sema) : void"	  ]


# 15:23:58 >  
# 15:23:58 >  Done.
# 15:23:58 >  

