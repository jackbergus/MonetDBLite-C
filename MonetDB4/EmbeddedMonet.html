<!--
The contents of this file are subject to the MonetDB Public License
Version 1.1 (the "License"); you may not use this file except in
compliance with the License. You may obtain a copy of the License at
http://monetdb.cwi.nl/Legal/MonetDBLicense-1.1.html

Software distributed under the License is distributed on an "AS IS"
basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
License for the specific language governing rights and limitations
under the License.

The Original Code is the MonetDB Database System.

The Initial Developer of the Original Code is CWI.
Portions created by CWI are Copyright (C) 1997-2007 CWI.
All Rights Reserved.
-->

<h1> Embedded MonetDB </h1>
<p>
The Embedded MonetDB version is optimized for running on small board computers
as a database back-end for a single Mapi client.
Within this context, much of the code to facilitate and protect 
concurrent use of the kernel can be disabled. For example, locking of critical
resources is not needed anymore, which results in significant 
performance improvements.
</p>
<p>
The embedded version can also be used as a Mserver instance
with a single client. The server should be started as follows:
<pre>
 Mserver --set gdk_embedded=yes --dbinit="module(mapi);listen();" &
</pre>
It will start the server in 'daemon' mode, loads the mapi module,
and starts listening for the first, and only client.
</p>
<p>
The Embedded MonetDB is made available as a library to be linked 
with the application code, a C-program. See SQL src/tools/prog.c example.
</p>
<p>
The following MIL commands are disabled or conflict with the 
embedded processing mode
<ol>
<li> fork, to spawn a new process thread </li>
<li> threadcnt, in- (de-)creasing the number of threads </li>
</ol>
</p>
<h3> Rationale</h3>
<p>
We can not support multiple MAPI connections to the embedded kernel, 
because each connection would lead to a thread awaiting input.
Evidently, both threads may receive MIL requests, which should be
synchronized. Although each thread could be given exclusive access, such
a situation quickly leads to hard to handle raise conditions and
detection of deadlocks in the application.
</p>
<p>
The implementation is organized around two global variables, monet_embedded 
and GDKembedded. They are set using a configuration parameter. Moreover,
setting monet_embedded implies also setting GDKembedded, and turning
the server into a daemon process.
</p>
<p>
The minimal footprint of MonetDB is about 15 Mb (+ ca 4Mb for SQL).
After module loading the space quickly grows to about 60Mb.
This footprint should be reduced.
</p>
<p>
</p>
